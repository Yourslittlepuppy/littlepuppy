
---

抽取文档关键词
===

抽取文档关键词用于在一篇文章中获取其核心内容（描述了什么？），又叫 生成摘要、打标签、关键词提取等

---

## 1：词频统计

* 词在文本中出现的次数（频次），某种程度上能当做文本的标签，表示文本内容
* 不是很精准
* 统计前最好先去完成自定义词典和去停用词的前期操作


```python
import numpy as np
import pandas as pd

import jieba
import jieba.analyse
```


```python
a = '哎，鹅，听说你超级喜欢小游戏的！你是吗？哎，鹅'
a
```




    '哎，鹅，听说你超级喜欢小游戏的！你是吗？哎，鹅'



略过自定义词典、去停用词


```python
x = jieba.lcut(a)
x
```

    Building prefix dict from the default dictionary ...
    Loading model from cache C:\Users\cd\AppData\Local\Temp\jieba.cache
    Loading model cost 0.974 seconds.
    Prefix dict has been built succesfully.
    




    ['哎',
     '，',
     '鹅',
     '，',
     '听说',
     '你',
     '超级',
     '喜欢',
     '小游戏',
     '的',
     '！',
     '你',
     '是',
     '吗',
     '？',
     '哎',
     '，',
     '鹅']




```python
pd.DataFrame(x)

pd.DataFrame(x).groupby(0).size().sort_values(ascending=False)
pd.Series(x).value_counts()
```




    ，      3
    你      2
    鹅      2
    哎      2
    ！      1
    是      1
    听说     1
    喜欢     1
    超级     1
    小游戏    1
    的      1
    ？      1
    吗      1
    dtype: int64



### 案例：分析Python互联网招聘信息中的需求关键字


```python
# 载入文本数据
with open('data/work.txt', 'r', encoding='utf-8') as f:
#     print(f.read())
    txt = f.read()

print(txt)
```

    职位描述：
    
    岗位职责：
    负责公司互联网产品的编码、实施等工作。
    
    任职要求：
    1、大专及以上学历，3年python开发经验，1年以上大型服务器端开发经验。
    2、有良好的编码习惯，熟悉git代码管理工具。
    3、熟练在Linux各发行版下进行开发，熟练使用vim、Sublime、eclipse等文本编辑器或IDE工具进行程序开发。
    4、至少熟练使用Django、Flask、Web.py、Tornado等Web框架中的一种。
    5、熟练运用MySQL、Oracle、Postgresql中的一项或多项进行数据库开发。
    6、熟悉和具有MongoDB、Redis、memecached等NoSQL数据库开发经验者优先。
    7、熟悉RESTFul风格、Oauth协议、MQTT协议等框架或技术者优先。
    8、具有大规模高并发访问Web应用架构设计和开发经验者优先。
    9、对代码有追求, 有分享精神者优先。
    
    ===========
    
    职能类别：
    软件工程师互联网软件开发工程师
    关键字：python
    职位描述：
    主要工作职责：
    1、基于Linux的应用软件开发，物联网应用方向（工业自动化、智能楼宇、远程监控等）；
    2、参与需求分析、系统架构设计；
    3、根据设计文档或需求说明完成代码编写、调试和维护；
    4、协助配合其他人员实现系统在实际环境的可靠运行。
    
    —————
    
    职位要求：
    1、扎实的C++基础，具备OOP编程思想，精通Python语言，熟悉多线程应用开发；
    2、有linux应用项目开发经历（包括服务端、网络通讯、web等）；
    3、熟悉数据库及SQL，有MySQL等关系型数据库开发经验
    4、良好的团队合作精神，有责任感；
    

#### 方式1：使用词频方式提取关键词


```python
# 1：自定义词典
jieba.load_userdict('data/custom.txt')  # 应用自定义词典
```


```python
# 2：分词

cut = jieba.lcut(txt)
cut
```




    ['职位',
     '描述',
     '：',
     '\n',
     '\n',
     '岗位职责',
     '：',
     '\n',
     '负责',
     '公司',
     '互联网',
     '产品',
     '的',
     '编码',
     '、',
     '实施',
     '等',
     '工作',
     '。',
     '\n',
     '\n',
     '任职',
     '要求',
     '：',
     '\n',
     '1',
     '、',
     '大专',
     '及',
     '以上学历',
     '，',
     '3',
     '年',
     'python',
     '开发',
     '经验',
     '，',
     '1',
     '年',
     '以上',
     '大型',
     '服务器端',
     '开发',
     '经验',
     '。',
     '\n',
     '2',
     '、',
     '有',
     '良好',
     '的',
     '编码',
     '习惯',
     '，',
     '熟悉',
     'git',
     '代码',
     '管理工具',
     '。',
     '\n',
     '3',
     '、',
     '熟练',
     '在',
     'Linux',
     '各',
     '发行版',
     '下',
     '进行',
     '开发',
     '，',
     '熟练',
     '使用',
     'vim',
     '、',
     'Sublime',
     '、',
     'eclipse',
     '等',
     '文本编辑',
     '器',
     '或',
     'IDE',
     '工具',
     '进行',
     '程序开发',
     '。',
     '\n',
     '4',
     '、',
     '至少',
     '熟练',
     '使用',
     'Django',
     '、',
     'Flask',
     '、',
     'Web',
     '.',
     'py',
     '、',
     'Tornado',
     '等',
     'Web',
     '框架',
     '中',
     '的',
     '一种',
     '。',
     '\n',
     '5',
     '、',
     '熟练',
     '运用',
     'MySQL',
     '、',
     'Oracle',
     '、',
     'Postgresql',
     '中',
     '的',
     '一项',
     '或',
     '多项',
     '进行',
     '数据库',
     '开发',
     '。',
     '\n',
     '6',
     '、',
     '熟悉',
     '和',
     '具有',
     'MongoDB',
     '、',
     'Redis',
     '、',
     'memecached',
     '等',
     'NoSQL',
     '数据库',
     '开发',
     '经验',
     '者',
     '优先',
     '。',
     '\n',
     '7',
     '、',
     '熟悉',
     'RESTFul',
     '风格',
     '、',
     'Oauth',
     '协议',
     '、',
     'MQTT',
     '协议',
     '等',
     '框架',
     '或',
     '技术',
     '者',
     '优先',
     '。',
     '\n',
     '8',
     '、',
     '具有',
     '大规模',
     '高',
     '并发',
     '访问',
     'Web',
     '应用',
     '架构设计',
     '和',
     '开发',
     '经验',
     '者',
     '优先',
     '。',
     '\n',
     '9',
     '、',
     '对',
     '代码',
     '有',
     '追求',
     ',',
     ' ',
     '有',
     '分享',
     '精神',
     '者',
     '优先',
     '。',
     '\n',
     '\n',
     '=',
     '=',
     '=',
     '=',
     '=',
     '=',
     '=',
     '=',
     '=',
     '=',
     '=',
     '\n',
     '\n',
     '职能',
     '类别',
     '：',
     '\n',
     '软件',
     '工程师',
     '互联网',
     '软件开发',
     '工程师',
     '\n',
     '关键字',
     '：',
     'python',
     '\n',
     '职位',
     '描述',
     '：',
     '\n',
     '主要',
     '工作',
     '职责',
     '：',
     '\n',
     '1',
     '、',
     '基于',
     'Linux',
     '的',
     '应用软件',
     '开发',
     '，',
     '物',
     '联网',
     '应用',
     '方向',
     '（',
     '工业',
     '自动化',
     '、',
     '智能',
     '楼宇',
     '、',
     '远程',
     '监控',
     '等',
     '）',
     '；',
     '\n',
     '2',
     '、',
     '参与',
     '需求',
     '分析',
     '、',
     '系统',
     '架构设计',
     '；',
     '\n',
     '3',
     '、',
     '根据',
     '设计',
     '文档',
     '或',
     '需求',
     '说明',
     '完成',
     '代码',
     '编写',
     '、',
     '调试',
     '和',
     '维护',
     '；',
     '\n',
     '4',
     '、',
     '协助',
     '配合',
     '其他',
     '人员',
     '实现',
     '系统',
     '在',
     '实际',
     '环境',
     '的',
     '可靠',
     '运行',
     '。',
     '\n',
     '\n',
     '—',
     '—',
     '—',
     '—',
     '—',
     '\n',
     '\n',
     '职位',
     '要求',
     '：',
     '\n',
     '1',
     '、',
     '扎实',
     '的',
     'C++',
     '基础',
     '，',
     '具备',
     'OOP',
     '编程',
     '思想',
     '，',
     '精通',
     'Python',
     '语言',
     '，',
     '熟悉',
     '多线程',
     '应用',
     '开发',
     '；',
     '\n',
     '2',
     '、',
     '有',
     'linux',
     '应用',
     '项目',
     '开发',
     '经历',
     '（',
     '包括',
     '服务端',
     '、',
     '网络通讯',
     '、',
     'web',
     '等',
     '）',
     '；',
     '\n',
     '3',
     '、',
     '熟悉',
     '数据库',
     '及',
     'SQL',
     '，',
     '有',
     'MySQL',
     '等',
     '关系',
     '型',
     '数据库',
     '开发',
     '经验',
     '\n',
     '4',
     '、',
     '良好',
     '的',
     '团队',
     '合作',
     '精神',
     '，',
     '有',
     '责任感',
     '；']




```python
# 3：去停用词

# 载入停用词表
stopword = []
with open('data/stopword.txt', 'r', encoding='utf-8') as f:
    for line in f.readlines():
        l = line.strip()
        if l == '\\n':
            l = '\n'
        if l == '\\u3000':
            l = '\u3000'

        stopword.append(l)

stopword

##################

# 去停用词,第一步，求差集
x = np.array(cut)  # 将分好的词列表转为数组
y = np.array(stopword)  # 将停用词转为数组
z = x[~np.in1d(x, y)]  # x的元素是否包含于y

# 去掉一个字的词
k = [i for i in z if len(i) > 1]
k
```




    ['岗位职责',
     '负责',
     '公司',
     '实施',
     '任职',
     '大专',
     '以上学历',
     'python',
     '大型',
     '服务器端',
     'git',
     '管理工具',
     'Linux',
     '发行版',
     'vim',
     'Sublime',
     'eclipse',
     '文本编辑',
     'IDE',
     '工具',
     '程序开发',
     '至少',
     'Django',
     'Flask',
     'Web',
     'py',
     'Tornado',
     'Web',
     '框架',
     '一种',
     'MySQL',
     'Oracle',
     'Postgresql',
     '一项',
     '多项',
     '数据库',
     'MongoDB',
     'Redis',
     'memecached',
     'NoSQL',
     '数据库',
     'RESTFul',
     '风格',
     'Oauth',
     '协议',
     'MQTT',
     '协议',
     '框架',
     '技术',
     '大规模',
     '并发',
     '访问',
     'Web',
     '架构设计',
     '追求',
     '分享',
     '职能',
     '类别',
     '软件',
     '软件开发',
     '关键字',
     'python',
     '职责',
     'Linux',
     '应用软件',
     '联网',
     '方向',
     '工业',
     '自动化',
     '智能',
     '楼宇',
     '远程',
     '监控',
     '分析',
     '架构设计',
     '设计',
     '文档',
     '编写',
     '调试',
     '维护',
     '协助',
     '配合',
     '环境',
     '运行',
     '扎实',
     'C++',
     '基础',
     '具备',
     'OOP',
     '编程',
     '思想',
     '精通',
     'Python',
     '语言',
     '多线程',
     'linux',
     '项目',
     '经历',
     '包括',
     '服务端',
     '网络通讯',
     'web',
     '数据库',
     'SQL',
     'MySQL',
     '数据库',
     '团队',
     '合作',
     '责任感']




```python
# 4：计算词频并排序
result = pd.Series(k).value_counts()[:20]
result
```




    数据库           4
    Web           3
    Linux         2
    协议            2
    架构设计          2
    python        2
    MySQL         2
    框架            2
    NoSQL         1
    思想            1
    网络通讯          1
    负责            1
    包括            1
    楼宇            1
    类别            1
    发行版           1
    远程            1
    memecached    1
    一种            1
    RESTFul       1
    dtype: int64




```python
# 5: 保存结果
result.to_csv('temp/keyword_fig.csv', header=0)
```

统计词频作为文档关键字的准确性不高，还可使用下面的方式

* TF-IDF算法
* Text-Rank算法

注：TF-IDF和Text-Rank算法运行都不需要手动去停用词，可以用内置函数自动去停用词

---

## 使用TF-IDF权重算法提取关键词

TF-IDF权重：

词频和重要词的综合分数(权重)

重要词：信息量大的词
    
    一个词信息量大小的衡量
    
    在本文章出现的次数多，在通用文档库出现的次数少，就是重要词
    
    如：你我他，你好再见 这些词信息量很小
    行业专有名词，如Python/MySQL，信息量就很大

* 首先，应用自定义词典
* 然后，去除停用词，系统自带，给抽取关键字用


```python
jieba.load_userdict('data/custom.txt')  # 应用自定义词典
jieba.analyse.set_stop_words('data/stopword.txt') # 抽取关键词前去掉自定义停用词
```


```python
txt
```




    '职位描述：\n\n岗位职责：\n负责公司互联网产品的编码、实施等工作。\n\n任职要求：\n1、大专及以上学历，3年python开发经验，1年以上大型服务器端开发经验。\n2、有良好的编码习惯，熟悉git代码管理工具。\n3、熟练在Linux各发行版下进行开发，熟练使用vim、Sublime、eclipse等文本编辑器或IDE工具进行程序开发。\n4、至少熟练使用Django、Flask、Web.py、Tornado等Web框架中的一种。\n5、熟练运用MySQL、Oracle、Postgresql中的一项或多项进行数据库开发。\n6、熟悉和具有MongoDB、Redis、memecached等NoSQL数据库开发经验者优先。\n7、熟悉RESTFul风格、Oauth协议、MQTT协议等框架或技术者优先。\n8、具有大规模高并发访问Web应用架构设计和开发经验者优先。\n9、对代码有追求, 有分享精神者优先。\n\n===========\n\n职能类别：\n软件工程师互联网软件开发工程师\n关键字：python\n职位描述：\n主要工作职责：\n1、基于Linux的应用软件开发，物联网应用方向（工业自动化、智能楼宇、远程监控等）；\n2、参与需求分析、系统架构设计；\n3、根据设计文档或需求说明完成代码编写、调试和维护；\n4、协助配合其他人员实现系统在实际环境的可靠运行。\n\n—————\n\n职位要求：\n1、扎实的C++基础，具备OOP编程思想，精通Python语言，熟悉多线程应用开发；\n2、有linux应用项目开发经历（包括服务端、网络通讯、web等）；\n3、熟悉数据库及SQL，有MySQL等关系型数据库开发经验\n4、良好的团队合作精神，有责任感；'




```python
jieba.analyse.extract_tags(txt)
```




    ['Web',
     '数据库',
     'python',
     'Linux',
     'MySQL',
     '架构设计',
     '框架',
     '多线程',
     '服务器端',
     '程序开发',
     '文本编辑',
     'git',
     'vim',
     'Sublime',
     'eclipse',
     'IDE',
     'Django',
     'Flask',
     'py',
     'Tornado']




```python
# 详细参数：

# 字符串
# 返回多少关键词，默认20个
# 是否返回TF-IDF权重
# allowPOS=(),什么词性可以做抽取，默认所有词
k = jieba.analyse.extract_tags(txt, topK=50, withWeight=True)
k
```




    [('Web', 0.3231018244027027),
     ('数据库', 0.3213358929827027),
     ('python', 0.21540121626846845),
     ('Linux', 0.21540121626846845),
     ('MySQL', 0.21540121626846845),
     ('架构设计', 0.21540121626846845),
     ('框架', 0.1304984974073874),
     ('多线程', 0.1252313301981982),
     ('服务器端', 0.1189867610036036),
     ('程序开发', 0.1189867610036036),
     ('文本编辑', 0.11274219180990991),
     ('git', 0.10770060813423422),
     ('vim', 0.10770060813423422),
     ('Sublime', 0.10770060813423422),
     ('eclipse', 0.10770060813423422),
     ('IDE', 0.10770060813423422),
     ('Django', 0.10770060813423422),
     ('Flask', 0.10770060813423422),
     ('py', 0.10770060813423422),
     ('Tornado', 0.10770060813423422),
     ('Oracle', 0.10770060813423422),
     ('Postgresql', 0.10770060813423422),
     ('MongoDB', 0.10770060813423422),
     ('Redis', 0.10770060813423422),
     ('memecached', 0.10770060813423422),
     ('NoSQL', 0.10770060813423422),
     ('RESTFul', 0.10770060813423422),
     ('Oauth', 0.10770060813423422),
     ('MQTT', 0.10770060813423422),
     ('C++', 0.10770060813423422),
     ('OOP', 0.10770060813423422),
     ('Python', 0.10770060813423422),
     ('linux', 0.10770060813423422),
     ('服务端', 0.10770060813423422),
     ('网络通讯', 0.10770060813423422),
     ('web', 0.10770060813423422),
     ('SQL', 0.10770060813423422),
     ('协议', 0.10719766658558559),
     ('岗位职责', 0.10649762261531531),
     ('管理工具', 0.10649762261531531),
     ('发行版', 0.09970688565675676),
     ('以上学历', 0.09698363455855855),
     ('大专', 0.09458991234504505),
     ('楼宇', 0.09346231646306306),
     ('需求', 0.0931674840927928),
     ('软件开发', 0.09054531576846847),
     ('文档', 0.08998787969864865),
     ('应用软件', 0.0898094776509009),
     ('编程', 0.0886507625354054),
     ('关键字', 0.08748669288243242)]



Text-Rank算法
---

TextRank是在Google的PageRank算法启发下，针对文本里的句子设计的权重算法，目标是自动摘要。

它利用投票的原理，让每一个单词给它的邻居（术语称窗口）投赞成票，票的权重取决于自己的票数。

效果比词频统计精准，和TF-IDF比各有千秋


```python
jieba.load_userdict('data/custom.txt')  # 应用自定义词典
jieba.analyse.set_stop_words('data/stopword.txt') # 抽取关键词前去掉自定义停用词
```


```python
# 文本
# 显示多少词
# 是否返回关键字权重
# allowPOS=(),什么词性可以做抽取，默认所有词
t = jieba.analyse.textrank(txt, topK=50, withWeight=True, allowPOS=('ns', 'n', 'vn', 'v'))
t
```




    [('协议', 1.0),
     ('需求', 0.9875781622534291),
     ('架构设计', 0.7990912009314232),
     ('合作', 0.7979708553780485),
     ('智能', 0.7750019954613007),
     ('思想', 0.6893106052137944),
     ('编程', 0.6566678601304772),
     ('具备', 0.6489359076864716),
     ('经历', 0.6443252766109469),
     ('包括', 0.6392962245041585),
     ('编写', 0.6320056962656291),
     ('工业', 0.5735987976983958),
     ('负责', 0.543863800396395),
     ('软件', 0.543863800396395),
     ('文本编辑', 0.5437082961798991),
     ('追求', 0.5437082961798991),
     ('配合', 0.5437082961798991),
     ('运行', 0.5437082961798991),
     ('岗位职责', 0.5413358992860875),
     ('职能', 0.5413358992860875),
     ('工具', 0.539745716954545),
     ('分享', 0.539745716954545),
     ('协助', 0.539745716954545),
     ('环境', 0.539745716954545),
     ('公司', 0.5385214268971106),
     ('类别', 0.5385214268971106),
     ('远程', 0.5213601844052318),
     ('监控', 0.519018034219794),
     ('调试', 0.449499573855616),
     ('维护', 0.4452651108217339),
     ('基础', 0.44433591157517077),
     ('项目', 0.44115556417631235),
     ('服务端', 0.4380585969235459),
     ('访问', 0.430314607491859),
     ('框架', 0.4296787018519657),
     ('技术', 0.4269876075312537),
     ('并发', 0.4263047387212311),
     ('设计', 0.42173315549375057),
     ('文档', 0.4196210646797763),
     ('团队', 0.41286960344195145),
     ('责任感', 0.41286960344195145),
     ('分析', 0.4045946342817329),
     ('方向', 0.3175114789280991),
     ('语言', 0.265305845762771),
     ('风格', 0.23701652178892793)]



附：词性标注
---

后附词性表


```python
a
```




    '哎，鹅，听说你超级喜欢小游戏的！你是吗？哎，鹅'




```python
list(jieba.posseg.cut(a))
```




    [pair('哎', 'e'),
     pair('，', 'x'),
     pair('鹅', 'n'),
     pair('，', 'x'),
     pair('听说', 'v'),
     pair('你', 'r'),
     pair('超级', 'b'),
     pair('喜欢', 'v'),
     pair('小游戏', 'n'),
     pair('的', 'uj'),
     pair('！', 'x'),
     pair('你', 'r'),
     pair('是', 'v'),
     pair('吗', 'y'),
     pair('？', 'x'),
     pair('哎', 'e'),
     pair('，', 'x'),
     pair('鹅', 'n')]




```python

```

---

## 中科院ICTCLAS分词汉语词性标记集

```
1. 名词 (1个一类，7个二类，5个三类)
名词分为以下子类：

n 名词

nr 人名

nr1 汉语姓氏

nr2 汉语名字

nrj 日语人名

nrf 音译人名

ns 地名

nsf 音译地名

nt 机构团体名

nz 其它专名

nl 名词性惯用语

ng 名词性语素

2. 时间词(1个一类，1个二类)
t 时间词

tg 时间词性语素

3. 处所词(1个一类)
s 处所词

4. 方位词(1个一类)
f 方位词

5. 动词(1个一类，9个二类)
v 动词

vd 副动词

vn 名动词

vshi 动词“是”

vyou 动词“有”

vf 趋向动词

vx 形式动词

vi 不及物动词（内动词）

vl 动词性惯用语

vg 动词性语素

6. 形容词(1个一类，4个二类)
a 形容词

ad 副形词

an 名形词

ag 形容词性语素

al 形容词性惯用语

7. 区别词(1个一类，2个二类)
b 区别词

bl 区别词性惯用语

8. 状态词(1个一类)
z 状态词

9. 代词(1个一类，4个二类，6个三类)
r 代词

rr 人称代词

rz 指示代词

rzt 时间指示代词

rzs 处所指示代词

rzv 谓词性指示代词

ry 疑问代词

ryt 时间疑问代词

rys 处所疑问代词

ryv 谓词性疑问代词

rg 代词性语素

10. 数词(1个一类，1个二类)
m 数词

mq 数量词

11. 量词(1个一类，2个二类)
q 量词

qv 动量词

qt 时量词

12. 副词(1个一类)
d 副词

13. 介词(1个一类，2个二类)
p 介词

pba 介词“把”

pbei 介词“被”

14. 连词(1个一类，1个二类)
c 连词

cc 并列连词

15. 助词(1个一类，15个二类)
u 助词

uzhe 着

ule 了 喽

uguo 过

ude1 的 底

ude2 地

ude3 得

usuo 所

udeng 等 等等 云云

uyy 一样 一般 似的 般

udh 的话

uls 来讲 来说 而言 说来

uzhi 之

ulian 连 （“连小学生都会”）

16. 叹词(1个一类)
e 叹词

17. 语气词(1个一类)
y 语气词(delete yg)

18. 拟声词(1个一类)
o 拟声词

19. 前缀(1个一类)
h 前缀

20. 后缀(1个一类)
k 后缀

21. 字符串(1个一类，2个二类)
x 字符串

xx 非语素字

xu 网址URL

22. 标点符号(1个一类，16个二类)
w 标点符号

wkz 左括号，全角：（ 〔 ［ ｛ 《 【 〖 〈 半角：( [ { <

wky 右括号，全角：） 〕 ］ ｝ 》 】 〗 〉 半角： ) ] { >

wyz 左引号，全角：“ ‘ 『

wyy 右引号，全角：” ’ 』

wj 句号，全角：。

ww 问号，全角：？ 半角：?

wt 叹号，全角：！ 半角：!

wd 逗号，全角：， 半角：,

wf 分号，全角：； 半角： ;

wn 顿号，全角：、

wm 冒号，全角：： 半角： :

ws 省略号，全角：…… …

wp 破折号，全角：—— －－ ——－ 半角：--- ----

wb 百分号千分号，全角：％ ‰ 半角：%

wh 单位符号，全角：￥ ＄ ￡ ° ℃ 半角：$
```


```python

```
